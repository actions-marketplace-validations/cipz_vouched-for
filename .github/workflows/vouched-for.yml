# Vouched for: verify the user who pushed (or opened the PR) is in the vouch list.
# Nushell is installed here; the vouched-for action assumes nu is already on PATH.
#
# Maintain .github/VOUCHED.td (or VOUCHED.td at repo root) with vouched usernames.

name: Vouched for

on:
  push:
    branches: [main, master]
  pull_request_target:
    types: [opened, reopened]

jobs:
  vouched-for:
    name: User must be vouched
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: read
    steps:
      - name: Check user is vouched
        uses: ./
        with:
          user: ${{ github.event.pull_request.user.login || github.actor }}
          ref: ${{ github.event.pull_request.base.ref || github.ref }}
